<h1>FT News Barcode</h1>

<h2>API URL generator</h2>

<form>
  <span>/barcode</span>
  <span>?width=</span>
  <input type="number" id="width" name="width" min="100" max="3000" placeholder="1024" value="1024"/>
  <span>&height=</span>
  <input type="number" id="height" name="height" min="100" max="3000" placeholder="768" value="768"/>
  <span>&dateFrom=</span>
  <input type="date" id="dateFrom" name="dateFrom" min="2018-01-01" max="2018-11-14" placeholder="2018-11-13" value="2018-11-13">
  <span>&dateTo=</span>
  <input type="date" id="dateTo" name="dateTo" min="2018-01-01" max="2018-11-14"  placeholder="2018-11-14" value="2018-11-14">
  <span>&orientation=</span>
  <select id="orientation" name="orientation">
    <option value="h" selected>horizontal</option>
    <option value="v">vertical</option>
  </select>
  <span>&fit=</span>
  <select id="fit" name="fit">
    <option value="cover" selected>cover</option>
    <option value="fill">fill</option>
  </select>
  <span>&share=</span>
  <select id="share" name="share">
    <option value="" selected></option>
    <option value="twitter">twitter</option>
  </select>
  <br />
  <a id="queryBuilderLink" target="blank" href="">/barcode</a>
</form>

<h2>Endpoints for Articles</h2>

<p>
  GET /barcode, returns Image
</p>
<p>
  Optional parameters
</p>
<ul>
  <li>
    <b>width</b> type : description - <i>(1024 default)</i>
  </li>
  <li>
    <b>height</b> type : description - <i>(768 default)</i>
  </li>
  <li>
    <b>dateFrom</b> type : description
  </li>
  <li>
    <b>dateTo</b> type : description
  </li>
  <li>
    <b>orientation</b> type : description - <i>(h default)</i>
  </li>
  <li>
    <b>fit</b> type : description - <i>(cover default)</i>
  </li>
  <li>
    <b>share</b> type : description - <i>(undefined default)</i>
  </li>
</ul>

  <br />
  e.g. <a href="/barcode?width=1024&height=768&dateFrom=2018-11-13&dateTo=2018-11-14&orientation=v&fit=cover">/barcode?width=1024&height=768&dateFrom=2018-11-13&dateTo=2018-11-14&orientation=v&fit=cover</a>
</p>

<script>
  const queryLink	= document.getElementById('queryBuilderLink');
  const width = document.getElementById('width');
  const height = document.getElementById('height');
  const dateFrom = document.getElementById('dateFrom');
  const dateTo = document.getElementById('dateTo');
  const orientation = document.getElementById('orientation');
  const fit = document.getElementById('fit');
  const share = document.getElementById('share');

  function init(){
    if(width !== undefined && height !== undefined && dateFrom !== undefined && dateTo !== undefined && orientation !== undefined && fit !== undefined && share !== undefined){
      width.addEventListener('change', updateUrlBuilderLink, false);
      height.addEventListener('change', updateUrlBuilderLink, false);
      dateFrom.addEventListener('change', updateUrlBuilderLink, false);
      dateTo.addEventListener('change', updateUrlBuilderLink, false);
      orientation.addEventListener('change', updateUrlBuilderLink, false);
      fit.addEventListener('change', updateUrlBuilderLink, false);
      share.addEventListener('change', updateUrlBuilderLink, false);
      updateUrlBuilderLink();
    }
  }

  function updateUrlBuilderLink(){
    const widthVal = width.value;
    const heightVal = height.value;
    const dateFromVal = dateFrom.value;
    const dateToVal = dateTo.value;
    const orientationVal = orientation.options[orientation.selectedIndex].value;
    const fitVal = fit.options[fit.selectedIndex].value;
    const shareVal = share.options[share.selectedIndex].value;
    const shareCheck = (shareVal) ? `&share=${shareVal}` : '';

    let str = `/barcode?width=${widthVal}&height=${heightVal}&dateFrom=${dateFromVal}&dateTo=${dateToVal}&orientation=${orientationVal}&fit=${fitVal}${shareCheck}`;

    queryLink.href = str;
    queryLink.innerHTML = str;
  }

  function getMultipleSelects(select){
    return select.reduce( (result, item) => {
      if(item.selected === true){
        result.push(item.value);
      }
      return result;
    }, []);
  }

  init();
</script>
